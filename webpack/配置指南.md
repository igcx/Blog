# webpack基本使用

+ 创建一个文件夹`webpack-demo`
+ 初始化项目

```bash
yarn init -y
```

+ 安装webpack的依赖包

```bash
yarn add webpack webpack-cli -D
```

+ 新建文件`src`和`dist`文件夹，，src用于提供源码，，dist用于存放打包后的文件
+ 在src下新建了`index.js`文件，目的：对`src/index.js`文件进行打包

+ 在package.json文件配置了打包的脚本

```js
  "scripts": {
    "build": "webpack --config webpack.config.js"
  }
```

+ 在项目的根目录，创建一个文件`webpack.config.js`
+ 执行打包命令

```js
yarn build
```



# 配置webpack的打包入口

+ 在`webpack.config.js`文件中

```js
// 这是webpack的配置文件 
// webpack是运行在node环境中，webpack可以执行任意的node代码，包括可以使用node中模块。
module.exports = {
  // 默认： ./src/index.js
  entry: './src/app.js'
}
```



# 配置webpack的打包出口

```js
  // 配置webpack打包出口
  output: {
    // path： 打包出口的目录,默认 dist, 必须指定绝对路径
    path: path.join(__dirname, 'lib'),
    // filename: 打包出口的文件名字  默认 main.js
    filename: 'bundle.js'
  }
```

==如果要配置path，记得是绝对路径==



# 配置webpack的打包模式

```js
  // 打包模式  development|production
  // development: 打包不会对进行压缩   打包快
  // production: 打包会对代码进行压缩  上线
  mode: 'development'
```





# 配置html-webpack-plugin插件

> html-webpack-plugin插件能够帮助我们自动在dist中生成一个html文件，并且会自动帮我们引入打包后的文件。

+ 安装html-webpack-plugin插件

```bash
yarn add html-webpack-plugin -D
```

+ 在`webpack.config.js`中配置

```js
//1. 导入html-webpack-plugin插件
const HtmlWebpackPlugin = require('html-webpack-plugin')

// 2.配置webpack的插件，是一个数组
plugins: [new HtmlWebpackPlugin({
  // 生成html的模板
  template: './src/index.html'
})]
```





# 配置css-loader处理css文件

> webpack天生只能处理js文件，如果需要处理其他类型的文件，需要配置loader

+ 安装依赖包

```js
yarn add css-loader style-loader -D
```

+ 配置loader

```js
module: {
  rules: [
    // 配置css-loader的规则
    {
      // 匹配所有.css结尾的文件
      test: /\.css$/,
      // 使用css-loader 和 style-loader处理
      use: ['style-loader', 'css-loader']
    }
  ]
}
```

==注意：loader加载顺序从右往左==





# 配置less-loader处理less文件

+ 安装依赖包

```bash
yarn add less-loader less -D
```

+ 配置less-loader

```js
// 配置less-loader的规则
{
  // 匹配所有.less结尾的文件
  test: /\.less$/,
    // 使用css-loader 和 style-loader处理
    use: ['style-loader', 'css-loader', 'less-loader']
}
```





# 配置file-loader处理图片

+ 安装依赖包

```
yarn add file-loader -D
```

+ 配置file-loader

```js
// file-loader配置
{
  test: /\.(png|jpg|gif)$/,
  use: 'file-loader'
}
```





# 配置url-loader处理图片

+ 安装

```js
yarn add url-loader file-loader -D
```

+ 配置url-loader

```js
{
  test: /\.(png|jpg|gif)$/,
  use: {
    loader: 'url-loader',
    options: {
      limit: 20 * 1024
    }
  }
}
```

# 配置字体图标和音视频

```js
// 字体图标
{
  test: /\.(eot|svg|ttf|woff)$/,
  use: {
    loader: 'url-loader',
    options: {
      limit: 20 * 1024
    }
  }
},
{
  test: /\.(mp3|mp4|ogg)$/,
  use: {
    loader: 'url-loader',
    options: {
      limit: 20 * 1024
    }
  }
}
```



# 配置babel-loader

> babel可以把高版本的js语法转成低版本的js语法，保证运行的效果一样。能够兼容更多的浏览器。

+ 安装依赖包

```js
yarn add  babel-loader @babel/core @babel/preset-env -D
```

+ 配置babel



```js
{
  test: /\.m?js$/,
  exclude: /(node_modules|bower_components)/,
  use: {
    loader: 'babel-loader',
    options: {
      presets: ['@babel/preset-env']
    }
  }
}
```





# 提取css到单独的文件中

+ 安装插件

```js
yarn add mini-css-extract-plugin -D
```

+ 配置插件

```js
const MiniCssExtractPlugin = require('mini-css-extract-plugin');

// 配置插件
plugins: [
  new MiniCssExtractPlugin({
    // 指定生成的css文件名和路径
    filename: './index.css',
  })
],
```

+ 配置css和less的loader

```js
{
  test: /\.css$/,
  // css-loader只能够让webpack能够处理css文件
  // style-loader： 能够把处理好的css代码添加到页面中
  // MiniCssExtractPlugin.loader ; 把css提取到单独的css文件中
  use: [MiniCssExtractPlugin.loader, 'css-loader']
},
{
  test: /\.less$/,
  use: [MiniCssExtractPlugin.loader, 'css-loader', 'less-loader']
},
```



# 优化css的路径

```js
// 配置插件
plugins: [
  new MiniCssExtractPlugin({
    // 指定生成的css文件名和路径
    filename: './css/index.css',
  })
],
```

问题：资源会加载失败

```js
{
  test: /\.css$/,
    // css-loader只能够让webpack能够处理css文件
    // style-loader： 能够把处理好的css代码添加到页面中
    // loader加载顺序： 从右往左加载
    use: [
      {
        loader: MiniCssExtractPlugin.loader,
        options: {
          // 去上一层目录加载静态资源
          publicPath: '../'
        }
      }, 
      'css-loader'
    ]
},
  {
    test: /\.less$/,
      use: [
        {
          loader: MiniCssExtractPlugin.loader,
          options: {
            // 去上一层目录加载静态资源
            publicPath: '../'
          }
        }, 
        'css-loader', 
        'less-loader'
      ]
  },
```





# 优化了生成的图片和字体图标的路径

```js
{
  test: /\.(png|jpg|gif)$/,
  use: {
    loader: 'url-loader',
    options: {
      // 限制  如果文件小于20k，那么就会使用url-loader，如果文件大于20k，这个文件会自动使用file-loader处理
      limit: 8 * 1024,
      outputPath: './images',
      name: '[name].[ext]'
    }
  }
},
// 字体图标
{
  test: /\.(eot|svg|ttf|woff)$/,
  use: {
    loader: 'url-loader',
    options: {
      limit: 20 * 1024,
      outputPath: './fonts',
      name: '[name].[ext]'
    }
  }
},
```



# webpack-dev-server的使用

> webpack-dev-server不是用来打包的，而是用于启动一个服务器，，，，，当我们代码发生了改变，webpack-dev-server会重新打包（内存）并且会刷新浏览器，实时看到效果

+ 安装包

```bash
yarn add webpack-dev-server -D
```

+ 配置一个脚本

```js

  "scripts": {
    "build": "webpack --config webpack.config.js",
    "dev": "webpack-dev-server --config webpack.config.js"
  },
```

+ 使用dev脚本

```
yarn dev
```

+ 常见配置

```js
  // devServer的配置
  devServer: {
    // 自定义端口
    port: 9090,
    // 自动打开浏览器
    open: true
  }
```

# ES6的模块化语法

## 精确导出

+ 导出

```js
// a.js
export function fn() {
  console.log('哈哈哈')
}
export const num = 11
exprot const age = 18
```



+ 导入

```js
import {fn, num} from './a'
```

==导入的变量必须得是模块导出的变量，名字要一致==



## 默认导出

+ 导出

```js
// a.js
function fn() {
  console.log('哈哈哈')
}
 const num = 11
 const age = 18
 
 export default {
   fn,
   num,
   age
 }
```

+ 导入

```js
import obj from './a'

// a就是默认导出的那个对象
```





# webpack处理vue文件

+ 新建了一个`App.vue`文件

```js
<template>
  <div class="app">我是根组件 ---{{msg}}  --<demo></demo> </div>
</template>

<script>
export default {
  data() {
    return {
      msg: 'hello'
    }
  },
}
</script>

<style>
.app {
  background-color: red;
}
</style>
```

+ 在main.js中导入`App.vue`根组件，并且渲染成为根组件

```js
import Vue from 'vue'
import App from './App.vue'

const vm = new Vue({
  el: '#app',
  // 把App组件渲染成根组件
  render: c => c(App),
  // 把app渲染成为根组件
  // render: function(createElement) {
  //   return createElement(App)
  // }
})
```

+ 报错，因为webpack处理不了vue文件

+ 安装依赖包

```js
yarn add vue-loader@15.9.0 vue-template-compiler -D    
```

+ 在webpack.config.js中配置vue-loader

```js
const VueLoaderPlugin = require('vue-loader/lib/plugin')

  plugins: [
    new VueLoaderPlugin()
  ],
    
    rules: [
      {
        test: /\.vue$/,
        loader: 'vue-loader'
      }
    ]
```

